; extensions.conf - the Asterisk dial plan
;
; Static extension configuration file, used by
; the pbx_config module. This is where you configure all your
; inbound and outbound calls in Asterisk.
;
; This configuration file is reloaded
; - With the "dialplan reload" command in the CLI
; - With the "reload" command (that reloads everything) in the CLI
;  Asterisk dial plan Azure bot  Application
;  This dial plan application interacts with Azure bot  API via UniMRCP server.
;   * Revision: 1
;   * Date: May 5, 2021
;   * Vendor: Universal Speech Solutions LLC

;================================UNIMRCPAZUREBOT=============================
exten=>764,1,Goto(synthandrecog-azurebot,s,1)

;================================UNIMRCPAZUREBOT=============================


[synthandrecog-azurebot]

exten => s,1,Answer

exten => s,2,Set(PROMPT="Welcome to Azure Echo bot. Say something i will repeat your phrase")

exten => s,3,SynthAndRecog(${PROMPT},builtin:speech/transcribe,plt-1&nif=json&b=1&sct=1000&sint=15000&nit=10000,spl=en-US&p=azurebot)

exten => s,4,Verbose(1, status: ${RECOG_STATUS}, completion-cause: ${RECOG_COMPLETION_CAUSE}, result: ${RECOG_RESULT})

exten => s,5,GotoIf($["${RECOG_STATUS}" = "OK"]?6:11)

exten => s,6,GotoIf($["${RECOG_COMPLETION_CAUSE}" = "000"]?7:11)

exten => s,7,Verbose(1, confidence: ${RECOG_CONFIDENCE(0)}, grammar: ${RECOG_GRAMMAR(0)}, input: ${RECOG_INPUT(0)}, instance: ${RECOG_INSTANCE(0/0)})

exten => s,8,Verbose(1, got next prompt: ${RECOG_INSTANCE(0/0/text)})

exten => s,9,Set(PROMPT=${RECOG_INSTANCE(0/0/speak)})

exten => s,10,Goto(3)

exten => s,11,MRCPSynth(Thank you. See you next time!)

exten => s,12,Hangup
;================================UNIMRCPAZUREBOT==============================

